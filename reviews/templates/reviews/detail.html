{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% block content %}
  <h1>리뷰 디테일</h1>
  <h1>{{ review.title }}</h1>
  <p>{{ review.pk }}번 게시글</p>
  <h3>
    <a href="{% url 'accounts:index'%}">{{ review.user.username }}</a>
  </h3>
  <p>
    {{ review.created_at|date:"SHORT_DATETIME_FORMAT" }}
    |
    <!-- -->
    {{ review.updated_at|date:"y-m-d D" }}
  </p>

  <span>
    {% if request.user.is_authenticated %}
      <a href="{% url 'reviews:like' review.pk %}">
        {% if request.user in review.like_users.all %}
          <button type="button" class="btn btn-outline-secondary">좋아요 취소</button>
        {% else %}
          <button type="button" class="btn btn-outline-danger">좋아요</button>
        {% endif %}
      </a>{{ review.like_users.count}}</span>
  {% endif %}

  <p>{{ review.content }}</p>
  {% if review.image %}
    <img src="{{ review.image.url }}" alt="{{ review.image }}" width="400" height="300"/>
  {% endif %}
  {% if request.user == review.user %}
    <p>
      <a href="{% url 'reviews:update' review.pk %}">수정하기</a>
    </p>
    <p>
      <a href="{% url 'reviews:delete' review.pk %}">삭제하기</a>
    </p>
  {% endif %}
  <h4 class="my-3">댓글</h4>
  {% if request.user.is_authenticated %}
    <form action="{% url 'reviews:comment_create' review.pk %}" method="POST">
      {% csrf_token %}
      {% bootstrap_form comment_form layout='inline'%}
      <!-- -->
      {% bootstrap_button button_type="submit" content="OK" %}
    </form>
  {% endif %}
  <hr/>
  {% for comment in comments %}
    <p>{{ comment.user.username }}
      |
      {{ comment.content }}</p>
      <a href="{% url 'reviews:comment_delete' review.pk comment.pk %}">삭제하기</a>
    <hr/>
    {% empty %}
    <p>댓글이 없어요 ㅠ_ㅠ</p>
  {% endfor %}
{% endblock content %}
